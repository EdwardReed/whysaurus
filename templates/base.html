<!DOCTYPE html>
<html>
	<head>
	  <link type="text/css" rel="stylesheet" href="/static/css/main.css" />
		<link type="text/css" href="/static/css/cupertino/jquery-ui-1.8.18.custom.css" rel="stylesheet" />	
	  <script type="text/javascript" src="/static/js/tinymce/tiny_mce.js"></script>
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" ></script>	
		<script type="text/javascript" src="/static/js/jquery-ui-1.8.18.custom.min.js"></script>
	  <script type="text/javascript">
  		tinyMCE.init({
		        // General options
		        mode : "textareas",
		        theme : "advanced",
		        editor_selector : "mceEditor",
		        editor_deselector : "mceNoEditor",
		        paste_text_sticky: true,
            paste_text_sticky_default: true,
		        plugins : "autolink,lists,spellchecker,advhr,advlink,iespell,inlinepopups,noneditable,paste",
		        // Theme options
		        theme_advanced_buttons1 : "bold,italic,underline,|,sub,sup,bullist,numlist,blockquote,|,undo,redo,|,link,unlink,image,code,spellchecker",
		        theme_advanced_buttons2 : "",
		        theme_advanced_buttons3 : "",
						theme_advanced_buttons4 : "",
						theme_advanced_toolbar_location : "top",
		        theme_advanced_toolbar_align : "left",
		        theme_advanced_statusbar_location : "bottom",
		        theme_advanced_resizing : false,
		        // Skin options
		        skin : "o2k7",
		        skin_variant : "silver", 
		        // Drop lists for link/image/media/template dialogs
		        template_external_list_url : "js/template_list.js",
		        external_link_list_url : "js/link_list.js",
		        external_image_list_url : "js/image_list.js",
		        media_external_list_url : "js/media_list.js",
		});
		
		function checkPointContent(content) {
		  var result = "";
		  var firstImage = content.indexOf("<img");
		  if (firstImage == 0) {
		    result = "";
		  } else if (firstImage > 4) {
		    result = "Images must be placed at the beginning of the point."
	    } else {
		    var secondImage = content.indexOf("<img", firstImage+1);
		    if (secondImage > 0) {
	        result = "Cannot have more than one image in the point."
		    }
		  }
		  return result;
		}
		function getWindowHeight() {
		  var height;

      if (typeof(window.innerHeight) == "number") //non-IE
          height = window.innerHeight;
      else if (document.documentElement && document.documentElement.clientHeight) //IE 6+ strict mode
          height = document.documentElement.clientHeight;
      else if (document.body && document.body.clientHeight) //IE 4 compatible / IE quirks mode
          height = document.body.clientHeight;
          
      return height;
		}
		function toDialogFormHeight(id, minus) {
        var height;
        height = $(this).height( $('#dialogForm').closest('.ui-dialog').height());
        document.getElementById(id).style.height = (height - minus) + "px";
    }
    
    function json_decode (str_json) {
      // http://kevin.vanzonneveld.net
      // +      original by: Public Domain (http://www.json.org/json2.js)
      // + reimplemented by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
      // +      improved by: T.J. Leahy
      // +      improved by: Michael White
      // *        example 1: json_decode('[\n    "e",\n    {\n    "pluribus": "unum"\n}\n]');
      // *        returns 1: ['e', {pluribus: 'unum'}]
    /*
        http://www.JSON.org/json2.js
        2008-11-19
        Public Domain.
        NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.
        See http://www.JSON.org/js.html
      */

      var json = this.window.JSON;
      if (typeof json === 'object' && typeof json.parse === 'function') {
        try {
          return json.parse(str_json);
        } catch (err) {
          if (!(err instanceof SyntaxError)) {
            throw new Error('Unexpected error type in json_decode()');
          }
          this.php_js = this.php_js || {};
          this.php_js.last_error_json = 4; // usable by json_last_error()
          return null;
        }
      }

      var cx = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
      var j;
      var text = str_json;

      // Parsing happens in four stages. In the first stage, we replace certain
      // Unicode characters with escape sequences. JavaScript handles many characters
      // incorrectly, either silently deleting them, or treating them as line endings.
      cx.lastIndex = 0;
      if (cx.test(text)) {
        text = text.replace(cx, function (a) {
          return '\\u' + ('0000' + a.charCodeAt(0).toString(16)).slice(-4);
        });
      }

      // In the second stage, we run the text against regular expressions that look
      // for non-JSON patterns. We are especially concerned with '()' and 'new'
      // because they can cause invocation, and '=' because it can cause mutation.
      // But just to be safe, we want to reject all unexpected forms.
      // We split the second stage into 4 regexp operations in order to work around
      // crippling inefficiencies in IE's and Safari's regexp engines. First we
      // replace the JSON backslash pairs with '@' (a non-JSON character). Second, we
      // replace all simple value tokens with ']' characters. Third, we delete all
      // open brackets that follow a colon or comma or that begin the text. Finally,
      // we look to see that the remaining characters are only whitespace or ']' or
      // ',' or ':' or '{' or '}'. If that is so, then the text is safe for eval.
      if ((/^[\],:{}\s]*$/).
      test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, '@').
      replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, ']').
      replace(/(?:^|:|,)(?:\s*\[)+/g, ''))) {

        // In the third stage we use the eval function to compile the text into a
        // JavaScript structure. The '{' operator is subject to a syntactic ambiguity
        // in JavaScript: it can begin a block or an object literal. We wrap the text
        // in parens to eliminate the ambiguity.
        j = eval('(' + text + ')');

        return j;
      }

      this.php_js = this.php_js || {};
      this.php_js.last_error_json = 4; // usable by json_last_error()
      return null;
    }
    
		</script>
	</head>
	<body>
  {% block mainPageContent %} {% endblock %}
	<div id="header"> 
		<div class="logoArea"><a href="/"><img id="logoImage" src="/static/img/whysaurus_logo.png"/></a>
		Version Alpha
		</div>
		<div class="userArea">		
		{% if user %}
      <a href="{{ user.link }}"><img id="avatar" src="{{ user.avatar_url }}"/>{{ user.name|escape }}</a>
      <a href="/logout" class="btn">Logout</a>
		{% else %}
  		Login with
		  <a href="/auth/facebook" class="btn"> Facebook</a><br>
		  OR <a href="/auth/google" class="btn"> Google</a>
		{% endif %}
		</div>
  	<div class="clear"></div>
	</div>

	<div id="footer"> 
    		<div class="footerCopyright">(c) Whysaurus 2012 </div>
		<div class="clear"></div>
	</div>
	</body>
</html>
